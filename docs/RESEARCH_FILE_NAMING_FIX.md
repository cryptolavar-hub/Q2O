# Research File Naming Fix

## Issue
Research files generated by the ResearcherAgent had extremely long filenames that were hard to distinguish. Examples:
- `Backend_Auth_system_JWT_refresh_tokens_SSO_Tenant-aware_database_models_CRUD_for_projects_tasks_users_teams_Realtime_WebSocket_server_code_File_upload_logic_Billing_webhook_handlers_Stripe_20251125_021340.json`
- `Constraints__Preferences_Must_scale_to_thousands_of_tenants_Should_work_with_low_latency_for_global_teams_Architecture_must_support_future_features___AI_assistants_Chat_summarization_Calendar_sync_Enterprise_LDAP_20251125_021431.md`

These filenames:
- Used the entire research query as the filename
- Were difficult to distinguish from each other
- Could cause filesystem issues (path length limits)
- Made it hard to identify files at a glance

## Root Cause
In `agents/researcher_agent.py`, the `_save_research_results` method was using the entire research query as the filename:

```python
safe_query = re.sub(r'[^\w\s-]', '', query).strip().replace(' ', '_')
json_filename = f"{safe_query}_{timestamp}.json"
```

This meant that long research queries (which often contain full objective descriptions) resulted in extremely long filenames.

## Solution
Updated `_save_research_results` to use the `generate_concise_name` utility (already created for task naming) combined with `sanitize_for_filename`:

```python
# Generate concise filename instead of using full query
from utils.name_generator import generate_concise_name
from utils.name_sanitizer import sanitize_for_filename

# Generate a concise name from the query (max 50 chars for filename)
concise_name = generate_concise_name(query, agent_type="RESEARCHER", max_length=50)
# Sanitize for filesystem (removes invalid chars, limits length)
safe_filename = sanitize_for_filename(concise_name, max_length=50)
timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")

json_filename = f"{safe_filename}_{timestamp}.json"
```

## Expected Results
Instead of:
- `Backend_Auth_system_JWT_refresh_tokens_SSO_Tenant-aware_database_models_CRUD_for_projects_tasks_users_teams_Realtime_WebSocket_server_code_File_upload_logic_Billing_webhook_handlers_Stripe_20251125_021340.json`

Files will now be named like:
- `backend_auth_jwt_sso_20251125_021340.json`
- `file_storage_integrations_20251125_021340.json`
- `security_rbac_encryption_20251125_021340.json`

## Benefits
1. **Shorter filenames**: Max 50 characters + timestamp (vs potentially 200+ characters)
2. **More descriptive**: Extracts key concepts rather than using full query
3. **Easier to distinguish**: Each file has a unique, meaningful name
4. **Filesystem safe**: Respects path length limits and invalid character restrictions
5. **Consistent**: Uses the same naming utilities as other agents

## Files Modified
- `agents/researcher_agent.py` - Updated `_save_research_results` method to use concise name generation

## Status
âœ… **FIXED** - Research files will now have concise, descriptive names instead of extremely long query-based names.

